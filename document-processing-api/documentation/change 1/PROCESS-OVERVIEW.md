# Document Processing â€” What's Really Happening

## What You See

```
    ğŸ“„ Word File    â”€â”€â”€>    ğŸŒ HTML Page

    "Just convert it, how hard can it be?"
```

## What's Actually Happening

```
    ğŸ“„ Word File
         â”‚
         â”‚  Step 1: Open the box
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                              â”‚
    â”‚   A Word file is actually an archive         â”‚
    â”‚   containing 10+ separate files inside it.   â”‚
    â”‚                                              â”‚
    â”‚   Think of it like a box with:               â”‚
    â”‚   â€¢ The actual text                          â”‚
    â”‚   â€¢ The formatting rules                     â”‚
    â”‚   â€¢ All the images (as separate files)       â”‚
    â”‚   â€¢ All the footnotes (as a separate file)   â”‚
    â”‚   â€¢ Table structures                         â”‚
    â”‚   â€¢ Mathematical equations                   â”‚
    â”‚   â€¢ Shapes and drawings                      â”‚
    â”‚   â€¢ List numbering rules                     â”‚
    â”‚   â€¢ Page layout settings                     â”‚
    â”‚                                              â”‚
    â”‚   Each of these needs to be read separately  â”‚
    â”‚   and understood in relation to the others.  â”‚
    â”‚                                              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚  Step 2: Find the equations
                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                              â”‚
    â”‚   Equations are scattered across 5 different â”‚
    â”‚   locations inside the file. Some are inside â”‚
    â”‚   shapes, some are copies for compatibility  â”‚
    â”‚   with older versions of Word.               â”‚
    â”‚                                              â”‚
    â”‚   A document with 150 equations might        â”‚
    â”‚   actually contain 250+ equation fragments   â”‚
    â”‚   when you count all the hidden copies.      â”‚
    â”‚                                              â”‚
    â”‚   Each one must be found and identified.     â”‚
    â”‚                                              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚  Step 3: Translate every equation
                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                              â”‚
    â”‚   Each equation is a tree of nested pieces.  â”‚
    â”‚   For example, one equation might contain:   â”‚
    â”‚                                              â”‚
    â”‚   "the integral from 0 to infinity of        â”‚
    â”‚    a fraction whose numerator is the         â”‚
    â”‚    square root of x-squared plus y-squared   â”‚
    â”‚    and whose denominator is sigma times      â”‚
    â”‚    the sine of theta"                        â”‚
    â”‚                                              â”‚
    â”‚   That's: an integral, containing a          â”‚
    â”‚   fraction, containing a square root,        â”‚
    â”‚   containing a superscript, plus Greek       â”‚
    â”‚   letters, plus a function name â€” all        â”‚
    â”‚   nested inside each other.                  â”‚
    â”‚                                              â”‚
    â”‚   There are 20+ different piece types.       â”‚
    â”‚   Each needs its own translation rule.       â”‚
    â”‚   Multiply that by 150 equations.            â”‚
    â”‚                                              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚  Step 4: Convert everything else
                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                              â”‚
    â”‚   Equations are only part of the job.        â”‚
    â”‚   The system also handles:                   â”‚
    â”‚                                              â”‚
    â”‚   â€¢ Headings (6 levels)                      â”‚
    â”‚   â€¢ Tables (merged cells, widths, nesting)   â”‚
    â”‚   â€¢ Footnotes (with clickable links          â”‚
    â”‚     that go both directions)                 â”‚
    â”‚   â€¢ Images (extracted to a folder)           â”‚
    â”‚   â€¢ Bold, italic, superscript text           â”‚
    â”‚   â€¢ Numbered and bullet lists                â”‚
    â”‚   â€¢ Shapes and drawings                      â”‚
    â”‚   â€¢ Hyperlinks                               â”‚
    â”‚   â€¢ Arabic right-to-left text                â”‚
    â”‚   â€¢ Section breaks                           â”‚
    â”‚                                              â”‚
    â”‚   All of this must work together correctly.  â”‚
    â”‚                                              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚  Step 5: Assemble the page
                       â–¼
                  ğŸŒ HTML Page + ğŸ“ Images folder


    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    This was built ONCE for the current system.

    The new change requires building the
    equation translation engine A SECOND TIME
    with completely different output rules.

    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## Don't Existing Tools Already Do This?

**Honest answer: partially, but none cover our full set of requirements.**

There are tools that handle PARTS of this problem. Here's what they can and cannot do:

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                â”‚
    â”‚                   WHAT WE NEED (all together)                  â”‚
    â”‚                                                                â”‚
    â”‚   âœ“ Convert equations (150+ per document)                     â”‚
    â”‚   âœ“ Convert full document structure (tables, footnotes, etc.) â”‚
    â”‚   âœ“ Arabic right-to-left text support                         â”‚
    â”‚   âœ“ Clean MathML output (no JavaScript)                       â”‚
    â”‚   âœ“ Specific HTML format (wordhtml.com conventions)           â”‚
    â”‚   âœ“ Automated batch processing                                â”‚
    â”‚   âœ“ Free / no per-seat licensing costs                        â”‚
    â”‚                                                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tool 1: Pandoc (free, open source, code-callable)

**The closest alternative.** Pandoc is a command-line tool that CAN convert Word to HTML with MathML equations. It can be called from code and handles batch processing.

```
    What Pandoc CAN do                What Pandoc CANNOT do well
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    âœ“ Convert equations to MathML     âœ— RTL + footnotes are broken
    âœ“ Handle basic tables               (footnote numbers appear in
    âœ“ Handle basic footnotes              wrong position in Arabic)
    âœ“ Handle images                   âœ— Equations get repositioned
    âœ“ Batch processing                  (moved to end of paragraph
    âœ“ Free                               instead of staying inline)
                                      âœ— No wordhtml.com format
                                      âœ— Table annotations lost
                                      âœ— No control over HTML style
```

Pandoc's RTL + footnote bug and equation positioning issues are **documented and open** on their GitHub. For Arabic academic documents with 150 equations, these are not minor issues â€” they break the output.

### Tool 2: Aspose.Words (commercial API, code-callable)

**A commercial product** that can convert Word to HTML. It has a MathML output mode.

```
    What Aspose CAN do                What Aspose CANNOT do well
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    âœ“ Convert to HTML                 âœ— Costs $1,199+ per developer
    âœ“ MathML output mode              âœ— Had equation-to-image issues
    âœ“ Handle tables, footnotes           for years (logged 2016,
    âœ“ Professional support               described as "more complex
                                         than initially estimated")
                                      âœ— Some MathML rendering bugs
                                        (special math fonts, notations)
                                      âœ— No wordhtml.com format
                                      âœ— Ongoing licensing cost
```

Aspose could work for some use cases, but it's expensive and has had its own documented struggles with equation conversion.

### Tool 3: Equation-only converters (free, code-callable)

Libraries like `omml2mathml` (Ruby), `scienceai/omml2mathml` (JavaScript), and Microsoft's XSLT stylesheet.

```
    What they CAN do                  What they CANNOT do
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    âœ“ Convert equations only          âœ— No document handling at all
    âœ“ Can be called from code         âœ— No footnotes, tables, images
    âœ“ Free                            âœ— No RTL support
                                      âœ— No HTML generation
                                      âœ— Microsoft's XSLT has known bugs
                                      âœ— You still need to build
                                        everything else around them
```

### Tool 4: wordhtml.com and similar online converters

```
    What they CAN do                  What they CANNOT do
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    âœ“ Convert basic documents         âœ— Equations are STRIPPED entirely
    âœ“ Nice HTML output                  (they disappear from output)
    âœ“ Easy to use                     âœ— Manual only (no API)
                                      âœ— Cannot process 150 equations
                                      âœ— Not automatable
```

---

## Why Our Custom Solution Exists

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                            â”‚
    â”‚  The problem is not that these tools are bad.              â”‚
    â”‚  The problem is that NO SINGLE TOOL handles the            â”‚
    â”‚  COMBINATION of all our requirements:                      â”‚
    â”‚                                                            â”‚
    â”‚    Accurate equations                                      â”‚
    â”‚    + Full document structure                                â”‚
    â”‚    + Arabic right-to-left text                              â”‚
    â”‚    + Clean MathML (no JavaScript)                           â”‚
    â”‚    + Specific output format                                 â”‚
    â”‚    + Automated processing                                   â”‚
    â”‚    + No licensing costs                                     â”‚
    â”‚                                                            â”‚
    â”‚  Pandoc comes closest but breaks on RTL + equations.        â”‚
    â”‚  Aspose works but costs $1,199+ per developer.              â”‚
    â”‚  Equation-only tools need an entire system built around     â”‚
    â”‚  them â€” which is essentially what we built.                 â”‚
    â”‚                                                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## The Scale of Work

```
    WHAT WAS ALREADY BUILT:

        10+ source code files
        ~3,000 lines of code
        20+ equation element handlers
        100+ mathematical symbol mappings
        Full web interface
        Cloud deployment pipeline


    WHAT THE NEW CHANGE ADDS:

        1 new source file
        ~735 new lines of code
        20+ NEW equation handlers (different format)
        4 existing files modified
        1,080-line technical specification
        All existing features still work
```
